<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Medical Diagnostics Portal</title>
  <link href="style.css" rel="stylesheet" type="text/css" />
  <meta name="csrf-token" content="">
</head>
<body>
  <div class="container">
    <header>
      <h1>Medical Diagnostics Portal</h1>
      <div class="user-info">
        <span id="userRole"></span>
      </div>
    </header>
    
    <div class="login-section" id="loginSection">
      <div class="tabs">
        <button class="tab-btn active" onclick="showTab('login')">Login</button>
        <button class="tab-btn" onclick="showTab('register')">Register</button>
      </div>
      
      <div id="loginTab" class="tab-content">
        <h2>Login</h2>
        <div id="loginError" class="error-message" aria-live="polite"></div>
        <form id="loginForm" onsubmit="login(); return false;">
          <select id="role" aria-label="Select user role" onchange="toggleLoginFields()">
            <option value="doctor">Doctor</option>
            <option value="patient">Patient</option>
          </select>
          <div id="doctorFields">
            <input type="text" 
                   id="doctorUsername" 
                   name="doctorUsername"
                   placeholder="Doctor Username"
                   required
                   minlength="3"
                   aria-label="Doctor Username">
          </div>
          <div id="patientFields" style="display: none;">
            <input type="text" id="loginPatientId" placeholder="Patient ID">
          </div>
          <input type="password" id="loginPassword" placeholder="Password">
          <button type="submit">Login</button>
        </form>
      </div>

      <div id="registerTab" class="tab-content" style="display:none">
        <h2>Register Patient</h2>
        <input type="text" id="regPatientId" placeholder="Patient ID">
        <input type="text" id="regName" placeholder="Full Name">
        <input type="password" id="regPassword" placeholder="Password">
        <input type="password" id="regConfirmPassword" placeholder="Confirm Password">
        <button onclick="register()">Register</button>
      </div>
    </div>

    <div class="main-content" id="mainContent" style="display: none;">
      <button id="logoutBtn" class="logout-btn">Logout</button>
      <!-- Doctor's View -->
      <div id="doctorView" class="role-view">
        <div class="test-input-section">
          <h3>Add New Test Result</h3>
          <input type="text" id="patientId" placeholder="Patient ID">
          <input type="text" id="diagnosticsId" placeholder="Diagnostics ID">
          <select id="testType">
            <option value="blood">Blood Test</option>
            <option value="urine">Urine Analysis</option>
            <option value="xray">X-Ray</option>
            <option value="mri">MRI</option>
          </select>
          <input type="text" id="testResult" placeholder="Test Result">
          <textarea id="recommendedAction" placeholder="Recommended Action"></textarea>
          <button onclick="addTestResult()">Add Result</button>
        </div>
      </div>

      <!-- Patient's View -->
      <div id="patientView" class="role-view">
        <h3>My Test Results</h3>
      </div>

      <!-- Common View -->
      <div class="test-results">
        <h3>Test History</h3>
        <div id="testList" class="test-list"></div>
      </div>
      
      <!-- Removing the entire reports-section div -->
    </div>
  </div>
  <script src="script.js"></script>
</body>
</html>
